service: sms-api
provider:
  name      : aws
  runtime   : nodejs8.10
  region    : ur-region-5
  role      : arn:aws:iam::AAAABBBBCCCCDDDD:role/lambda_execution
  memorySize: 128
  timeout   : 5
  stage     : ${opt:stage, 'dev'}
functions:
  main:
    handler: index.run
    description: API that sends SMS
    environment:
      region: ${self:custom.region}
      # Table name
      tableSmsRecords: ${self:custom.tables.smsRecords}
      # SNS Topic
      topicSmsQueue: ${self:custom.topics.smsQueue}
    exclude: 
      - package-lock.json
    events:
      - http:
          path: "/${self:custom.callbackEndpoint}"
          method: post
resources:
  - ${file(resources/dynamodb.yml)}
  - ${file(resources/sns.yml)}
custom:
  region: ${opt:region, self:provider.region}
  callbackEndpoint: callback
  tables:
    smsRecords: sms_records
  topics:
    smsQueue: SMSQueue

